 


@{
    Layout = null;
    //要使视图不使用布局或模板页，那么需要把Layout赋值为空
}



<!doctype html>

<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=10,chrome=1" />
    <title>查看扫描件</title>
    <link href="~/Content/font-awesome-4.7.0/css/font-awesome.css" rel="stylesheet" />
    <link href="~/Content/PagedList.css" rel="stylesheet" type="text/css" />
    <link href="~/Content/jquery-ui.theme.css" rel="stylesheet" />
    @*@Styles.Render("~/Content/css")*@
    <link href="~/Content/Tabulator/version3.0/tabulator.css" rel="stylesheet" />
    <link type="text/css" rel="stylesheet" href="~/Scripts/jquery/jquery-ui.css" />
    @*<link href="~/Content/bootstrap.min.css" rel="stylesheet" />*@
    <link href="~/Content/bootstrap.css" rel="stylesheet" />
    <link href="~/Content/viewer/viewer.min.css" rel="stylesheet" />
    
    <script src="~/Scripts/jquery-2.1.1.min.js" type="text/javascript"></script>
    @*<script type="text/javascript" src="~/Scripts/jquery/jquery-1.8.3.js"></script>*@
    <script src="~/Scripts/jquery-ui.min.js"></script>
    <script src="~/Content/Tabulator/version3.0/tabulator.js"></script>
    <script src="~/Content/Tabulator/v3.2.2/tabulator.js"></script>
    <link href="~/Scripts/zTREE/css/AJAXControlToolKit.css" rel="stylesheet" />
    <script src="~/Scripts/LoadWebBrowseActiveX.js"></script>

    <script src="~/Scripts/bootstrap.min.js"></script>
    <script src="~/Content/viewer/viewer.min.js"></script>
    <script src="~/Content/viewer/viewer-jquery.min.js"></script>
  

   
 
    <style>
        * {
            margin: 0;
            padding: 0;
        }

        #dis li img {
          
            max-width: 28%;
            width: expression( ( this.width > 1000) ? 10000 : this.width );
          
            BORDER-RIGHT: 5px double;
            BORDER-TOP: 5px double;
            BORDER-LEFT: 5px double;
            BORDER-BOTTOM: 5px double;
        }

        /*#dowebok {
            width: 1200px;
            margin: 0 auto;
            font-size: 0;
        }

            #dowebok li {
              
                width: 32%;
                margin-left: 1%;
                padding-top: 1%;
            }

                #dowebok li img {
                    width: 100%;
                    width: expression( ( this.width > 300) ? 300 : this.width );
                    BORDER-RIGHT: 5px double;
                    BORDER-TOP: 5px double;
                    BORDER-LEFT: 5px double;
                    BORDER-BOTTOM: 5px double;
                }*/

        .file-preview {
            border-radius: 5px;
            border: 1px solid #ddd;
          
        }




       

        #List {
        }

            #List ul {
                margin: 0px;
                padding: 0px;
                list-style-type: none;
                vertical-align: middle;
            }

            #List li {
              
                width: 100px;
                height: 20px;
                line-height: 20px;
                font-size: 14px;
                font-weight: bold;
                color: #666666;
                text-decoration: none;
                text-align: left;
                background: #ffffff;
            }
          
    .divcss5 {
        border: 100px solid #F00;
        width:0px;
        height:0px;
    }
    /*#wai{ width:500px; height:30px; border:1px solid green;}
    #nei{ width:0px; height:30px; background:green;}*/
    
    </style>
    @*<script type="text/javascript">
        function OnProgress() {
            var pic = document.getElementsByTagName('input')[0].files[0];
            var fd = new FormData();
            var xhr = new XMLHttpRequest();
            xhr.open('post', 'Butok', true);
            xhr.onreadystatechange = function () {
                if (this.readyState == 4) {
                    document.getElementById('precent').innerHTML = this.responseText;
                }
            }
            xhr.upload.onprogress = function (ev) {
                if (ev.lengthComputable) {
                    var precent = 100 * ev.loaded / ev.total;
                    console.log(precent);
                    document.getElementById('nei').style.width = precent + '%';
                    document.getElementById('precent').innerHTML = Math.floor(precent) + '%';
                }
            }
            fd.append('pic', pic);

            xhr.send(fd);
            
        }
    </script>*@
   
    <script language="javascript" type="text/javascript">
            var oldBorder;
            function SetNewBorder(oSrc) {
                oldBorder = oSrc.style.border;
                oSrc.style.border = "1px outset #00FFFF";
            }

            function SetOldBorder(oSrc) {
                oSrc.style.border = oldBorder;
            }
    </script>

    <script type="text/javascript" language="javascript">
            var details = function (value, data, cell, row, options) { //plain text value
                return "<i class='fa fa-search-plus' style='color:#428bca;vertical-align:middle; padding:2px 0;'></i> "
            };
            var m = function (value, data, cell, row, options) { //plain text value
                return "<i class='fa  fa-list-ol' style='color:#428bca;vertical-align:middle; padding:2px 0;'></i> "
            };
            var n = function (value, data, cell, row, options) { //plain text value
                return "<i class='fa fa-download' style='color:#428bca;;vertical-align:middle; padding:2px 0;'></i>/<i class='fa fa-search-plus' style='color:#428bca;;vertical-align:middle; padding:2px 0;'></i>"
            };

            var chec = function (value, data, cell, row, options) {

                //return '<input type="checkbox" name="chec" >';
                return "<i class='fa fa-search-plus' style='color:#428bca;vertical-align:middle; padding:2px 0;'></i>"
            };
            //var chec = function (value, data, cell, row, options) { //plain text value
            //    return "<i class='fa fa-search-plus' style='color:#428bca;vertical-align:middle; padding:2px 0;'></i>"
            //};
            $(document).ready(function () {
                //$("#btnSub").click(function () {
                window.focus();

                var path = GetQueryStringRegExp("Info");

                $.ajax({
                    type: "GET",
                    url: "/UrbanBorrow/GetUserAndImageList/?userSeqNo=" + path,
                    contentType: "application/json",
                    data: "",
                    dataType: "json",
                    success: function (data) {


                     
                        onSuccess(data);
                       
                    

                    }
                });

            });
            $().ready(function () {//在页面加载完成之后用，为了保证js能完整的执行。

                $(document).ready(function () {
                    var height = $(window).height();
                    var hh = height - 83;
                    $(".box-h").height(height)
                    $(".box-h1").height(hh)
                    var width = $(window).width();
                    var wid = width - 310;
                    $(".box-w").height(wid);

                })
                $("#example-table-2").tabulator({
                    
                    height: "100%",
                    virtualDom: false,
                    selectable:1, //make rows selectable
                    sortable: false,
                    pagination: "local",
                    paginationSize:50,
                    //pageLoaded:function(pageno){
                    //    alert(pageno);
                    //},

                    columns: [

                       {
                           title: "选择", field: "check", width: 50, headerSort: false, formatter: "tickCross",sorter: "string", align: "center", cellClick: function (e, cell) {
                               
                               if (cell.getRow().getData().check == false) {

                                   $("#example-table-2").tabulator("updateData", [{ id: cell.getRow().getData().id, check: true }]);

                               }
                               else {

                                   $("#example-table-2").tabulator("updateData", [{ id: cell.getRow().getData().id, check: false }]);
                               }

                           }
                       },
                    
                    { title: "文件序号", field: "a", width: 80, headerSort: false, align: "center"},
                    //{ title: "纸张类型", field: "pagesize", width: 80, headerSort: false, align: "center" },
                        {title: "文件名称", field: "Name", width: 270, headerSort: false, cellClick: function (e, cell) {
                  
                            if (document.getElementById("dowebok").childNodes.length != 0) {
                                for (var j = 0; j < document.getElementById("dowebok").childNodes.length; j++) {
                                    document.getElementById("dowebok").removeChild(document.getElementById("dowebok").childNodes[j]);
                                }

                            }

                            var add = cell.getRow().getData().WebPath;
                            var cont = cell.getRow().getData().id;
                            var name = cell.getRow().getData().Name;
                            str1 = "<li><img data-original=" + '"' + add + '"  ' + "id=" + '"' + cont + '"' + "src=" + '"' + add + '"  ';
                            str2 = str1 + "alt=" + '"' + name + '"' + "/>" + "<h4>" + name + "</h4></li>";
                           

                            //var obj = new Object();
                            //obj.name = cell.getRow().getData().Name;
                            //obj.path = cell.getRow().getData().WebPath;
                            
                            //var number = window.showModalDialog('/UrbanBorrow/PageSize/', obj, 'dialogWidth=0px;dialogHeight=10px;center:no;dialogLeft:800px;dialogTop:300px');
                            //document.getElementById('pagesize').value = number;
                            $("#dowebok").append(str2);
                            //var viewer = new Viewer(document.getElementById('dis'));

                            //viewer.view();
                            //$('#dowebok').viewer();
                            
                            Getsize(add);
                            $("#dowebok").viewer("destroy");
                            $("#dowebok").viewer();
                            //document.getElementById("div_WebBrowse").innerHTML = '';
                            //Getpagesize(obj);
                            //CollectGarbage();
                            
                            }
                        },


                    ],

                });
               

                $("#example-table-2").tabulator("getPage"); // returns current page



            });
            function Getsize(add)
            {
               
                $.ajax({
                    type: "POST",
                    url: "/UrbanBorrow/GetSize/?path=" + add,
                    contentType: "application/x-www-form-urlencoded",
                    data:"",
                    dataType: "json",
                    success: function (data) {
                       
                        document.getElementById('pagesize').value = data;

                    }
                });
            }
            function onSuccess(result) { //debugger;


                if (result == null || result == "undefined") {
                    alert("fail");
                    return;
                }
              
             
                var cnt = 0;
                if (result.length!= null) {
                    cnt = result.length;
                }

            
              

                onSuccessList(result);//加载图片显示列表

            }
      
            function onSuccessList(result) {


                alert("共" + result.length + "张扫描件");
                document.getElementById("count").value = result.length;
                var temp = new Array();
                var Data = result;
                //var arrNa2 = new Array();
                //var arrPa2 = new Array();
                //for (var i = 0; i <result.length; i++) 
                //{
                   
                //    arrNa2[i] =  Data[i].Name;
                //    arrPa2[i] =  Data[i].WebPath;
                       
                    
                //}
                //CreateControl("div_WebBrowse", arrPa2, arrNa2, result.length, "0002");
                //var a = fGetListPaperSizeAll();
                //var arrPa3 = new Array();
                //arrPa3 = a.split(',');
                for (var i = 0; i < Data.length; i++) {


                    var val = false;
                    temp.push({ "id": i + 1, "check": val, "a": i + 1, "Name": Data[i].Name, "WebPath": Data[i].WebPath, "ID": result[i].ID });
                }
                $("#example-table-2").tabulator("setData", temp);
            
                $(window).resize(function () {
                    $(document).ready(function () {
                        var height = $(window).height();
                        var hh = height - 83;
                        $(".box-h").height(height)
                        $(".box-h1").height(hh)
                        var width = $(window).width();
                        var wid = width - 310;
                        $(".box-w").height(wid);
                        $("#example-table-2").tabulator("redraw", true);

                    })
                });
            }
       
            function ShowCalendar2(idRes) {//alert("x = " + event.clientX + ";y = " + event.clientY);
                if (document.all.item(idRes) != null) {
                    var x = event.screenX + 20;
                    var y = event.screenY + 50;
                    var z = window.showModalDialog('/ArchiveSearch/borrowerHasRegistedInfo', 'dialogHeight:1000px;dialogWidth:1500px;dialogLeft:' + x + 'px;dialogTop:' + y + 'px;');

                    document.getElementById("userid1").value = z;

                }
            }
            $(document).ready(function () {
                $("#Add").click(function () {
                    var data = $("#example-table-2").tabulator("getData");
                    var m = 0;
                    var info1 = "";
                    var arr = new Array();
                    for (var i = 0; i < data.length; i++) {
                        if (data[i].check == true) {
                            arr[m] = data[i].WebPath;
                            m++;
                        }



                    }



                    var paperProjectSeqNo = GetQueryStringRegExp("paperProjectSeqNo");

                    var ArchiveNo = GetQueryStringRegExp("ArchiveNo");
                    var volNo = GetQueryStringRegExp("volNo");
                    ArchiveNo = ArchiveNo.toString().trim();
                    var regNo = GetQueryStringRegExp("regNo");
                    while (paperProjectSeqNo.length < 5) {
                        paperProjectSeqNo = "0" + paperProjectSeqNo;
                    }
                    var VolCnt1 = document.getElementById("VolCnt").value;

                    var userid = document.getElementById("userid1").value;


                    $.ajax({
                        type: "POST",
                        url: "/ArchiveSearch/Looksaomiaopost/?paperProjectSeqNo=" + paperProjectSeqNo + "&archiveNo=" + ArchiveNo + "&volNo=" + volNo + "&name1=" + "Add" + "&VolCnt1=" + VolCnt1 + "&userid=" + userid + "&regNo=" + regNo,
                        contentType: "application/x-www-form-urlencoded",
                        data: { arr1: arr },
                        dataType: "json",
                        success: function (data) {

                            if (data == "1") {
                                //alert("您尚未选择借阅人");
                                $("#Msg").val("您尚未选择借阅人");
                            }
                            if (data == "2") {
                                //alert("您尚未登记，请先登记");
                                $("#Msg").val("您尚未登记，请先登记");
                            }
                            if (data == "3") {
                                //alert("保存成功");
                                $("#Msg").val("保存成功");
                            }
                            if (data == "4") {
                                //alert("此图纸已保存");
                                $("#Msg").val("此图纸已保存");
                            }
                            if (data == "5") {
                                //alert("您尚未选择扫描件或借阅人");
                                $("#Msg").val("您尚未选择扫描件或借阅人");

                            }



                        }

                    });

                });
            });

            $(document).ready(function () {
                $("#btnDelSMJ").click(function () {

                    var info1 = GetControlInfo();
                    document.getElementById("txtLocation").value = info1;

                    var info = document.getElementById("txtLocation").value;

                    var paperProjectSeqNo = GetQueryStringRegExp("paperProjectSeqNo");

                    var ArchiveNo = GetQueryStringRegExp("ArchiveNo");
                    var volNo = GetQueryStringRegExp("volNo");
                    ArchiveNo = ArchiveNo.toString().trim();
                    var regNo = GetQueryStringRegExp("regNo");
                    while (paperProjectSeqNo.length < 5) {
                        paperProjectSeqNo = "0" + paperProjectSeqNo;
                    }
                    var VolCnt1 = document.getElementById("VolCnt").value;

                    var userid = document.getElementById("userid1").value;


                    $.ajax({
                        type: "POST",
                        url: "/ArchiveSearch/Looksaomiaopost/?paperProjectSeqNo=" + paperProjectSeqNo + "&archiveNo=" + ArchiveNo + "&volNo=" + volNo + "&info=" + info + "&name1=" + "Delete" + "&VolCnt1=" + VolCnt1 + "&userid=" + userid + "&regNo=" + regNo,
                        contentType: "application/json",
                        data: "",
                        dataType: "json",
                        success: function (data) {

                            if (data == "6") {
                                alert("扫描件删除成功");
                                $("#Msg").val("扫描件删除成功");
                            }



                        }

                    });

                });
            });
            $(document).ready(function () {
                $("#reback").click(function () {
                    window.close();
                });
            });
            function Pre() {



                var selectedData = $("#example-table-2").tabulator("getSelectedData");//获取选中的数据
                if (document.getElementById("dowebok").childNodes.length == 0) {
                    alert("请选择一条记录");
                }//需要选择一条记录
                else {
                    if (document.getElementById('flag5').value == 0)//下一条按钮已经不可用
                    {
                        document.getElementById('next').disabled = false;//恢复可用状态
                    }
                    for (var j = 0; j < document.getElementById("dowebok").childNodes.length; j++)//先破后立，清除dowebok的所有元素以便添加新元素，保证dowebok中只有一个元素存在
                    {
                        document.getElementById("dowebok").removeChild(document.getElementById("dowebok").childNodes[j]);
                    }
                    var flag2 = selectedData[0].id;
                    if (flag2 - 1 == 1) {

                        document.getElementById('pre').disabled = true;
                        document.getElementById('flag5').value = 1;
                        alert("这是第一条！");
                    }
                    $("#example-table-2").tabulator("selectRow", flag2 - 1)
                    var selectedData1 = $("#example-table-2").tabulator("getSelectedData");

                    var add = selectedData1[0].WebPath;
                    var cont = selectedData1[0].id;
                    var name = selectedData1[0].Name;
                    var str1 = "<li><img data-original=" + '"' + add + '"  ' + "id=" + '"' + cont + '"' + "src=" + '"' + add + '"  ';
                    var str2 = str1 + "alt=" + '"' + name + '"' + "/>" + "<h4>" + name + "</h4></li>";
                    //var obj = new Object();
                    //obj.name = selectedData1[0].Name;
                    //obj.path = selectedData1[0].WebPath;
                    //var number = window.showModalDialog('/UrbanBorrow/PageSize/', obj, 'dialogWidth=0px;dialogHeight=10px;center:no;dialogLeft:800px;dialogTop:300px');
                    //document.getElementById('pagesize').value = number;
                    //var obj = new Object();
                    //obj.name =name;
                    //obj.path =add;
                    $("#dowebok").append(str2);
                    $("#dowebok").viewer("destroy");
                    $("#dowebok").viewer();
                    Getsize(add);


                }

            }
            function next() {
                var selectedData = $("#example-table-2").tabulator("getSelectedData");//获取选中的数据
                if (document.getElementById("dowebok").childNodes.length == 0) {
                    alert("请选择一条记录");
                }
                else {
                    if (document.getElementById('flag5').value == 1)//上一条按钮已经不可用
                    {
                        document.getElementById('pre').disabled = false;//恢复可用状态
                    }

                    var flag2 = selectedData[0].id + 1;

                    for (var j = 0; j < document.getElementById("dowebok").childNodes.length; j++) {
                        document.getElementById("dowebok").removeChild(document.getElementById("dowebok").childNodes[j]);
                    }





                    if (flag2 == document.getElementById("count").value) {

                        document.getElementById('next').disabled = true;
                        document.getElementById('flag5').value = 0;
                        alert("这是最后一条！");
                    }

                    $("#example-table-2").tabulator("selectRow", flag2);
                    var selectedData1 = $("#example-table-2").tabulator("getSelectedData");
                    var add = selectedData1[0].WebPath;
                    var cont = selectedData1[0].id;
                    var name = selectedData1[0].Name;
                    var str1 = "<li><img data-original=" + '"' + add + '"  ' + "id=" + '"' + cont + '"' + "src=" + '"' + add + '"  ';
                    var str2 = str1 + "alt=" + '"' + name + '"' + "/>" + "<h4>" + name + "</h4></li>";
                    //var obj = new Object();
                    //obj.name = selectedData1[0].Name;
                    //obj.path = selectedData1[0].WebPath;
                    //var number = window.showModalDialog('/UrbanBorrow/PageSize/', obj, 'dialogWidth=0px;dialogHeight=10px;center:no;dialogLeft:800px;dialogTop:300px');
                    //document.getElementById('pagesize').value = number;
                    //var obj = new Object();
                    //obj.name = name;
                    //obj.path = add;
                    $("#dowebok").append(str2);
                    $("#dowebok").viewer("destroy");
                    $("#dowebok").viewer();

                    Getsize(add);
                }
            }
            $(document).ready(function () {

                $("#Butok").click(function () {

                    
                    //var path = GetQueryStringRegExp("Info");

                    //var number = window.showModalDialog('/UrbanBorrow/Tuzhiok/?userSeqNo=' + path, '', 'dialogWidth=0px;dialogHeight=10px');
                    //Loading();
                    //document.getElementById("Loading").style.display = "block";
                    document.getElementById("Butok").disabled = "true";
                    var arrIDs = "";
                    var data1 = $("#example-table-2").tabulator("getData");
                    //$("#example-table-2").tabulator("addFilter","check", "=", true);
                    //var data2 = $("#example-table-2").tabulator("getData", true); //return currently filtered data
                    var cnt1 = 0;
                    cnt1 = data1.length;
                    var obj1= new Object();
                    obj1.name = "";
                    obj1.path = "";
                    var arrNa1 = new Array();
                    var arrPa1 = new Array();
                    var ArrID1 = new Array();
                    var m1 = 0;
                    for (var i = 0; i < cnt1; i++) {
                        if (data1[i].check == true && data1[i].check != "undefined")
                        {
                            arrNa1[m1] = data1[i].Name;
                            arrPa1[m1] = data1[i].WebPath;
                            ArrID1[m1] = data1[i].ID;
                        
                            m1++;
                          
                        }
                    }
                   
                    for (var j = 0; j < arrNa1.length; j++) {

                        if (j <= arrNa1.length - 2) {
                            obj1.name = obj1.name + arrNa1[j] + ",";
                            obj1.path = obj1.path + arrPa1[j] + ",";
                        }
                        else {

                            obj1.name = obj1.name + arrNa1[j];
                            obj1.path = obj1.path + arrPa1[j];

                        }
                       
                        arrIDs = arrIDs + ArrID1[j] + ",";


                    }
                  
                    document.getElementById("txtImageId").value = arrIDs.substring(0, arrIDs.length - 1);
                  
                    //var number = window.showModalDialog('/UrbanBorrow/Tuzhiok/', obj1, 'dialogWidth=0px;dialogHeight=10px');
                  
                    //var a = document.getElementById('txtImageId').value;
                    
                    //var b = Getpagesize1(obj1);
                    //Getpagesize1(obj1);
                    //var b = document.getElementById('txtPaperSize').value
                    Getpagesize1(obj1);
                    



                });
            });
            $(document).ready(function () {

                $("#Print").click(function () {


                    var data = $("#example-table-2").tabulator("getData");
                    var cnt = 0;
                    cnt = data.length;
                    //var obj = new Object();
                    //obj.name = "";
                    //obj.path = "";
                    var arrNa = new Array();
                    var arrPa = new Array();
                    var m = 0;
                    for (var i = 0; i < cnt; i++) {
                        if (data[i].check == true && data[i].check != "undefined") {
                            arrNa[m] = data[i].Name;
                            arrPa[m] = data[i].WebPath;
                            m++;
                        }
                    }
                    //for (var j = 0; j < arrNa.length; j++) {

                    //    if (j <= arrNa.length - 2) {
                    //        obj.name = obj.name + arrNa[j] + ",";
                    //        obj.path = obj.path + arrPa[j] + ",";
                    //    }
                    //    else {

                    //        obj.name = obj.name + arrNa[j];
                    //        obj.path = obj.path + arrPa[j];

                    //    }




                    //}


                    //window.showModalDialog('/ArchiveSearch/SaomiaoPrint/', obj, 'dialogWidth=0px;dialogHeight=10px');
                    
                    
                    alert("共有" + m + "张扫描件需要打印");
                  
                    CreateControl("div_WebBrowse", arrPa, arrNa, m, "1111");
                });
            });
      
            $(document).ready(function () {

                $("#Allselect").click(function () {
                    var CurrentPage = $("#example-table-2").tabulator("getPage");
                    var MaxPage = $("#example-table-2").tabulator("getPageMax"); // returns maximum page
                    //alert(CurrentPage);
                    //alert(MaxPage);
                    var Data = $("#example-table-2").tabulator("getData");
                    document.getElementById("count").value = Data.length;
                 
             
                    var temp = new Array();
                    if (CurrentPage < MaxPage) {
                        for (var i = 0 ; i < 50 * CurrentPage - 50 ; i++) {
                            var val = false;
                            temp.push({ "id": i + 1, "check": val, "a": i + 1, "Name": Data[i].Name, "WebPath": Data[i].WebPath, "ID": Data[i].ID });
                        }
                        for (var i = 50 * CurrentPage - 50 ; i <= 50 * CurrentPage - 1 ; i++) {
                                var val = true;
                                temp.push({ "id": i + 1, "check": val, "a": i + 1, "Name": Data[i].Name, "WebPath": Data[i].WebPath, "ID": Data[i].ID });

                        }
                        for (var i = 50 * CurrentPage; i < Data.length ; i++) {
                            var val = false;
                            temp.push({ "id": i + 1, "check": val, "a": i + 1, "Name": Data[i].Name, "WebPath": Data[i].WebPath, "ID": Data[i].ID });

                        }
                       
                    }
                    else {
                        for (var i = 0; i < 50 * CurrentPage - 50 ; i++) {
                            var val = false;
                            temp.push({ "id": i + 1, "check": val, "a": i + 1, "Name": Data[i].Name, "WebPath": Data[i].WebPath, "ID": Data[i].ID });

                        }
                        for (var i = 50 * CurrentPage - 50 ; i < Data.length ; i++) {
                            var val = true;
                            temp.push({ "id": i + 1, "check": val, "a": i + 1, "Name": Data[i].Name, "WebPath": Data[i].WebPath, "ID": Data[i].ID });

                        }
                    }
                    
                    
                        
                            
                   

                    $("#example-table-2").tabulator("setData", temp);
                    $("#example-table-2").tabulator("setPage", CurrentPage);


                    $(window).resize(function () {
                        $(document).ready(function () {
                            var height = $(window).height();
                            var hh = height - 83;
                            $(".box-h").height(height)
                            $(".box-h1").height(hh)
                            var width = $(window).width();
                            var wid = width - 310;
                            $(".box-w").height(wid);
                            $("#example-table-2").tabulator("redraw", true);

                        })
                    });
                });

            });
            $(document).ready(function () {
                $("#Delselect").click(function () {
                    
                    var Data = $("#example-table-2").tabulator("getData");
                    document.getElementById("count").value = Data.length;
                    var temp = new Array();

                    for (var i = 0; i < Data.length; i++) {
                        var val = false;
                        temp.push({ "id": i + 1, "check": val, "a": i + 1, "Name": Data[i].Name, "WebPath": Data[i].WebPath,"ID": Data[i].ID });
                    }
                    $("#example-table-2").tabulator("setData", temp);
                    $(window).resize(function () {
                        $(document).ready(function () {
                            var height = $(window).height();
                            var hh = height - 83;
                            $(".box-h").height(height)
                            $(".box-h1").height(hh)
                            var width = $(window).width();
                            var wid = width - 310;
                            $(".box-w").height(wid);
                            $("#example-table-2").tabulator("redraw", true);

                        })
                    });
                });
            });
            function Getpagesize1(obj) {
               
                var cnt = 0;
                var arrPath = new Array();
                var arrName = new Array();
                arrPath = obj.path.split(',');
                arrName = obj.name.split(',');
                if (arrPath.length != null) {
                    cnt = arrPath.length;
                }
                //CreateControl("div_WebBrowse", arrPath, arrName, cnt, "0002");
                //var d = fGetListPaperSizeAll();

                $.ajax({
                    type: "POST",
                    url: "/UrbanBorrow/GetALLsize/",
                    contentType: "application/x-www-form-urlencoded",
                    data: { arrpa: arrPath },
                    dataType: "json",
                    success: function (data) {
                   
                        getSizeOk(data);

                    }
                });
                
            }
            function Getpagesize(obj)
            {
                var cnt = 0;
                var arrPath = new Array();
                var arrName = new Array();

                arrPath[0] = obj.path;
                arrName[0] = obj.name;

                if (arrPath.length != null) {
                    cnt = arrPath.length;
                }

               
                CreateControl("div_WebBrowse", arrPath, arrName, cnt, "0002");
                var a = fGetListPaperSizeAll();
          
                if(a=="16K")
                {
                    a="A4";
                }
                document.getElementById('pagesize').value = a;
            }
 
            //function Loading()
            //{
          
            //    document.getElementById('Loading').style.display = "block";

            //}

            //function Stop()
            //{
            //    document.getElementById('Loading').style.display = "none";
            //}
            function getSizeOk(data1)
            {
           
                var a = document.getElementById('txtImageId').value;
                data1 = data1.substring(0, data1.length - 1);
              
               
                $.ajax({
                    type: "POST",
                    url: "/UrbanBorrow/printLinq3ok/",
                    contentType: "application/x-www-form-urlencoded",
                    data: { txtImageId: a, txtPaperSize: data1 },
                    dataType: "json",
                    success: function (data) {
                        
                        if (data == "1") {

                            alert("保存成功");
                            //document.getElementById("Loading").style.display = "none";
                            document.getElementById("Butok").disabled = "";
                            $("#Msg").val("保存成功");

                        }

                        if (data == "2") {
                            alert("数据问题，保存失败");
                            //document.getElementById("Loading").style.display = "none";
                            document.getElementById("Butok").disabled = "";
                            $("#Msg").val("数据问题，保存失败");
                        }

                    }
                });
            }
    </script>
</head>


<body class="box-h" style="overflow:hidden;background:#ecf0f5;border:1px solid #ddd;padding:0px;margin:0px;">


    <div id="example-table-2" class="box-h" style="float:left;width:360px;"></div>

    <div class="file-preview box-h" id="con" style="padding:0px;margin:0px;border:0px;text-align:center">
        <form>
            <input id="txtLocation" hidden="hidden" />
            <input id="txtImageId" hidden="hidden" />
            <input id="txtIsTuzhi" hidden="hidden" />
            <input id="txtPaperSize" hidden="hidden" />

            @*<table class="table table-bordered dl-horizontal">
                                <tr>
                                    <td>
                                        <input id="txtLocation" hidden="hidden" />
                                        <input id="Button3" type="button" class="btn btn-default" value="选择借阅人" onclick="javascript:ShowCalendar2('userid1');" />
                                        <input id="userid1" disabled="disabled" />
                                        <input id="Add" type="button" value="添加到用户" class="btn btn-default" />
                                        <input id="Msg" style="border:0px;color:coral;background:#ecf0f5;width:100px" />
                                    </td>
                                    <td>
                                        竣工档案：【<input id="proNo" value="@ViewData["proNo"]" />】【第<input id="VolNo" value="@ViewData["VolNo"]" style="width:100px;" />/<input id="VolCnt" value="@ViewData["VolCnt"]" style="width:100px;" />卷】

                                    </td>
                                </tr>




                <div class="file-preview" id="con" style="display:inline;float:left;">
                    <div id="dis"></div>
                    <div id="dis1">

                <div class="file-preview" id="con" cstyle="display:inline;float:left;">
                    <div id="dis"></div>
                    <div id="dis1">

                            </table>*@


            <p >

                @*<input id="Button3" type="button" class="btn btn-default" value="选择借阅人" onclick="javascript:ShowCalendar2('userid1');" />
                    <input id="userid1" disabled="disabled" style="width:100px;" />*@
                @*<input id="Add" type="button" value="添加到用户" class="btn btn-default" />
                    <input id="reback" type="button" value="返回" class="btn btn-default" />*@
                <input id="Butok" type="button" value="保存图纸信息" class="btn btn-default" style="padding:5px 10px;"/>
                <input id="Print" type="button" value="打印"  class="btn btn-default" style="padding:5px 10px;"/>
                纸张类型：<input id="pagesize" name="pagesize" style="padding:3px;" />
                @*竣工档案：【<input id="proNo" value="@ViewData["proNo"]" style="width:100px;" />】【第<input id="VolNo" value="@ViewData["VolNo"]" style="width:100px;" />/<input id="VolCnt" value="@ViewData["VolCnt"]" style="width:100px;" />卷】*@
            </p>
            <div style="text-align:center;">
                <input id="Msg" style="border:0px;color:red;background:#ecf0f5;padding:5px 0px;font-size:large;" />
            </div>

        </form>
        <div id="part">

        </div>

        @*<div id="wai" style="text-align:center;">
            <div id="nei"></div>
        </div><span id="precent"></span><br />
        <input type="file" name="pic" onchange="OnProgress();" />*@ 

      <div id="Loading" style="display:none">

          @*<img src="~/Content/images/loading1.gif" />*@
          @*<img src="~/Content/images/jiazai1.gif" />*@
          @*<img src="~/Content/images/5-121204193R7-51.gif" />*@
      </div>
            <div id="dis" class="box-h1" style="display:block;margin-bottom:5px;margin-top:10px;">
                <input type="button" id="pre" value="上一条" onclick="Pre()" class="btn btn-default" style="padding:3px 6px;" />
                <input type="button" id="next" value="下一条" onclick="next()" class="btn btn-default" style="padding:3px 6px;" />
                <input type="button" id="Allselect" value="全选(单页)" class="btn btn-default" style="padding:3px 6px;" />
                <input type="button" id="Delselect" value="全删" class="btn btn-default" style="padding:3px 6px;" />
                @*<input type="button" id="Loading" value="加载" class="btn btn-default" style="padding:3px 6px;" />
                <input type="button" id="Stop" value="停止" class="btn btn-default" style="padding:3px 6px;" />*@
                
              
                <ul id="dowebok" style="margin-top:5px;"></ul>
            </div>


        @*<div id="Loading" style="display:none;margin-top:5px;">

            <img src="~/Content/images/jiazai.gif" />
        </div>*@
      
      
        </div>
        <input id="count" name="count" hidden="hidden" />@*记录扫描件条数*@
        <input id="flag" name="flag" value="0" hidden="hidden" />
        <input id="flag5" name="flag5" hidden="hidden" />
        <input id="flg" name="flg" hidden="hidden" value="1" />@*设置标识符，以确定当前状态是单选还是多选,1:单选2：多选*@
        <input id="storage" name="storage" hidden="hidden" />
    <div class="divcss5" id="div_WebBrowse"> </div>

    

</body>
</html>
