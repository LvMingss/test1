@model IEnumerable<urban_archive.Models.VideoCassetteList>
<link href="~/Content/jquery-ui.theme.css" rel="stylesheet" />
<link href="~/Content/Tabulator/tabulator.css" rel="stylesheet" />

@{
    ViewBag.Title = "Index";
}
<style type="text/css">
    .jubu {
        max-width: 100%;
    }
</style>
@*<link href="~/Content/bootstrap.min.css" rel="stylesheet" />*@
<link href="~/Content/upload/fileinput.min.css" rel="stylesheet" />
<link type="text/css" rel="stylesheet" href="~/Scripts/jquery/jquery-ui.css">

<script src="~/Scripts/jquery-2.1.1.min.js" type="text/javascript"></script>
<script type="text/javascript" src="~/Scripts/jquery/jquery-1.8.3.js"></script>
<script src="~/Scripts/jquery-ui.min.js"></script>

<script type="text/javascript" src="~/Scripts/jquery/jquery.ui.core.js"></script>
<script type="text/javascript" src="~/Scripts/jquery/jquery.ui.datepicker.js"></script>
<script type="text/javascript" src="~/Scripts/jquery/jquery.ui.widget.js"></script>
<script type="text/javascript" src="~/Scripts/jquery/jquery-ui-timepicker-addon.js"></script>
<script src="~/Content/Tabulator/tabulator.js"></script>

<script src="~/Content/upload/canvas-to-blob.min.js"></script>
<script src="~/Content/upload/sortable.min.js"></script>
<script src="~/Content/upload/purify.min.js"></script>
<script src="~/Content/upload/fileinput.min.js"></script>
<script src="~/Content/upload/zh.js"></script>
<script src="~/Scripts/bootstrap.min.js"></script>


<script>
            $(function () {
                $("#shootingDate").datepicker({
                    changeMonth: true,
                    changeYear: true
                });
            });
            function createIframe6() {
        
                var selectedData = $("#example-table-2").tabulator("getSelectedData"); 
                var name="";
                //alert(1);
                //alert(selectedData[0].archivesNo);
                for(var j=0;j<selectedData.length;j++)
                {
                    name+=selectedData[j].ID+",";
                }
                //var url3=document.getElementById("url1").value;
                //alert(name);
                //var url = '/ArchiveSearch/CurUserAdd/'+'?id3='+name+"&url1="+url3;
                //window.top.location.href =url;
                document.getElementById("checkname1").value=name;
            };
            function createIframe7()
            {
                var selectedData = $("#example-table-2").tabulator("getSelectedData"); 
                var name="";
                //alert(1);
                //alert(selectedData[0].archivesNo);
                for(var j=0;j<selectedData.length;j++)
                {
                    name+=selectedData[j].ID+",";
                }
                //alert(name);
                //var url = '/ArchiveSearch/NoCurUser/'+'?id3='+name;
                //window.top.location.href =url;
                document.getElementById("checkname1").value=name;
            };
</script>


<script type="text/javascript">
    var shangchuan = function (value, data, cell, row, options) { //plain text value
        return "<i class='glyphicon glyphicon-open' style='color:#428bca;;vertical-align:middle; padding:2px 0;'></i> "
        };
    var lookvideo = function (value, data, cell, row, options) { //plain text value
        return "<i class='fa fa-search-plus' style='color:#428bca;;vertical-align:middle; padding:2px 0;'></i> "
        };
    var lookphoto = function (value, data, cell, row, options) { //plain text value
            return "<i class='fa fa-search-plus' style='color:#428bca;vertical-align:middle; padding:2px 0;'></i> "
        };
    var shanchu = function (value, data, cell, row, options) { //plain text value
        return "<i class='glyphicon glyphicon-trash' style='color:#428bca;vertical-align:middle; padding:2px 0;'></i> "
    };
    var chec=function(value,data,cell,row,options){

        return '<input type="checkbox" name="chec" >';

    };
        $().ready(function () {//在页面加载完成之后用，为了保证js能完整的执行。
            $(document).ready(function () {
                var a = $(window).height();
                var hh = a-400;
                $(".box-h").height(hh)  // 高度加在类名为box的DIV 上

            })
            $("#example-table-2").tabulator({
                height: "100%",
                colMinWidth:100,
                fitColumns:true,
                sortable: false,
                selectable:true,
                pagination:"local",
                paginationSize:10,
                columns: [
                //   {
                //       title: "选择", field: "check",width: 100 ,formatter:chec,  sorter: "string", align: "center", onClick: function (e, val, cell, row) {
                //           //var url = '/ArchiveSearch/ProjectInfoes?id=' + row.projectID;
                //           //document.getElementById("text").value=row.projectID;
                //           //window.location.href = url;
                //           //var row1 = $("#example-table-2").datagrid("getSelected");
                //           //document.getElementById("text").value=row1.projectID;

                //           $("#checkname1").val(row.registrationNo);

                //       }
                //},
                {
                    title: "浏览视频", field: "caozuo2", width: 100 ,formatter: lookvideo, sortable: false, sorter: "string", align: "center", onClick: function (e, val, cell, row) {
                        var url = '/ArchiveSearch2/playvideo?id=' + row.ID
                        window.location.href = url;
                    }
                },
                {
                    title: "查看照片", field: "caozuo3", width: 100 ,formatter: lookphoto, sortable: false, sorter: "string", align: "center", onClick: function (e, val, cell, row) {
                        var url = '/ArchiveSearch2/lookphoto?id='+row.ID;
                        window.location.href = url;

                    }
                },
                //{
                //    title: "删除", field: "caozuo4", width: 100 ,formatter: shanchu, sortable: false, sorter: "string", align: "center", onClick: function (e, val, cell, row) {
                //        if(del()){
                //            var url = '/VideoCassetteLists/Delete?id='+row.ID;
                //            window.location.href = url;
                //        }
                //    }
                //},
                //{ title: "ID", field: "ID", sortable: false,width: 200 },
                //{ title: "序号", field: "ID", sortable: false,width: 300 },
                { title: "文件类型", field: "filingDesc",sortable: false, width: 300 },
                { title: "文件类别数", field: "videoMinutesCount",sortable: false, width: 300 },
                { title: "上传时间", field: "shootingDate",sortable: false},
                { title: "状态", field: "status",sortable: false},
                ],
            });

            var temp = new Array();
            var data=@Html.Raw(Json.Encode(Model));
            for (var i = 0; i < data.length;i++) {
                var b = data[i].shootingDate
                if(b!=null){
                    var date = new Date(parseInt(b.slice(6)))
                    var result = date.getFullYear()+'/'+(parseInt(date.getMonth())+1)+'/'+date.getDate()
                }
                temp.push({ "id": i + 1,"ID":data[i].ID,"status":data[i].checker,"filingDesc":data[i].filingDesc,"videoMinutesCount":data[i].videoMinutesCount, "shootingDate": result  });
            }

            $("#example-table-2").tabulator("setData", temp);
            $(window).resize(function () {
                $(document).ready(function () {
                    var a = $(window).height();
                    var hh = a-400;
                    $(".box-h").height(hh)  // 高度加在类名为box的DIV 上
                $("#example-table-2").tabulator("redraw",true);

                })
            });

        });
</script>

<div id="example-table-2" style="overflow:auto"> </div>
<input name="checkname1" id="checkname1" hidden="hidden">
@*</script>
<h2><i class="fa fa-tags kongge"></i>声像视频/照片上传</h2>
<h4>所属工程：@ViewBag.projectName&nbsp;&nbsp;&nbsp;&nbsp;工程序号：@ViewBag.videoProjectSeqNo</h4>*@

@*@Html.Action("PartialView_Create", new { videoProjectSeqNo = ViewBag.videoProjectSeqNo })
<div style="height:30px;"></div>*@

@*<div class="panel panel-default" style="margin-bottom:0px;background:#fff;">
    <table class="table table-bordered dl-horizontal">
        <tr>
            <td class="linear" style="font-size: 18px;color:white;text-align:center;">
                <i class="fa fa-check-square-o"></i>上传卷内备考表、卷内目录
            </td>
        </tr>
        @*<label class="control-label">上传卷内备考表、卷内目录</label>*@
        @*<tr>
            <td>
                <input id="input-22" name="input22[]" type="file" multiple class="file-loading">

            </td>
        </tr>
    </table>
</div>*@

@*<script>
        $(document).on('ready', function() {
            $("#input-22").fileinput({
                uploadUrl:"/VideoCassetteLists/UpLoad_jnml?videoProjectSeqNo="+@ViewBag.videoProjectSeqNo, // server upload action
                previewFileType: ["docx", "xlsx"],
                allowedFileExtensions: ["docx", "xlsx"]
                //previewClass: "bg-warning",
            });
        });
</script>*@

@*@using (Html.BeginForm("Index", "VideoCassetteLists", FormMethod.Post))
{
    @Html.AntiForgeryToken()
    <div style="height:30px;"></div>
        <div style="text-align:center"></div>
        <input type="text" name="videoProjectSeqNo" id="videoProjectSeqNo" value="@ViewBag.videoProjectSeqNo" hidden="hidden">
        <div style="text-align:center;">
            <p>*@
                @*<input type="submit" name="action" value="材料审核" class="btn btn-default" />*@
                @*<input type="submit" name="action" value="上传完成" class="btn btn-default" onclick="return tongguo()" />*@
                @*<input type="submit" name="action" value="驳回" class="btn btn-default" onclick="return bohui()" />
                <input type="submit" name="action" value="暂入库" class="btn btn-default" onclick="return dairuku()" />
                <a href="/VideoArchives/@ViewBag.fanhui" class="btn btn-default jubu">返回案卷列表</a>
            </p>
            <div style="height:5px"></div>
        </div>

}*@
